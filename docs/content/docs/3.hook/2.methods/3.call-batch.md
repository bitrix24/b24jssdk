---
title: B24Hook::callBatch()
description: 'Use B24Hook.callBatch() to execute batch requests to the Bitrix24 REST API. This allows you to execute up to 50 different commands in a single HTTP request, significantly increasing performance for bulk data operations. Works only in server environment.'
navigation:
  title: callBatch
links:
  - label: B24Hook
    iconName: GitHubIcon
    to: https://github.com/bitrix24/b24jssdk/blob/main/packages/jssdk/src/hook/controller.ts
  - label: TypeB24
    iconName: GitHubIcon
    to: https://github.com/bitrix24/b24jssdk/blob/main/packages/jssdk/src/types/b24.ts
---

::caution{title="⚠️ CAUTION: SECURITY"}
The `B24Hook` object is intended **exclusively for use on the server**.

- A webhook contains a secret access key, which **MUST NOT** be used in client-side code (browser, mobile app).
- For the client side, use [`B24Frame`](/docs/frame/).
::

## Quick Overview

Use `callBatch()`{lang="ts-type"} to execute up to 50 API commands in a single request. This is especially useful when you need to retrieve or update large amounts of data while minimizing network requests and adhering to API limits.

```ts
// Basic usage
import { B24Hook, EnumCrmEntityTypeId } from '@bitrix24/b24jssdk'

const $b24 = B24Hook.fromWebhookUrl('https://your_domain.bitrix24.com/rest/1/webhook_code/')

const response = await $b24.callBatch({
  ServerTime: { method: 'server.time' },
  UserProfile: { method: 'user.current' }
})
```

## Method Signature

```ts-type
callBatch(
  calls: Array<any> | Record<string, any>,
  isHaltOnError?: boolean,
  returnAjaxResult?: boolean
): Promise<Result>
```

### Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| **`calls`** | `Array<any> \| Record<string, any>`{lang="ts-type"} | Yes | A batch of calls. Can be represented in three formats: <br>1. **Array of arrays**: `[[method, params], [method, params]]` <br>2. **Array of objects**: `[{method, params}, {method, params}]` <br>3. **Object with named commands**: `{key: {method, params}, key2: [method, params]}` |
| **`isHaltOnError`** | `boolean`{lang="ts-type"} | No | **Halt on error.** The default is `true`, then execution of the batch is halted if an error occurs in any of the commands. If `false` - commands are executed even if some fail. |
| **`returnAjaxResult`** | `boolean`{lang="ts-type"} | No | **Return value format.** If `true`, the method returns a `Result` object containing either a `Record<string \| number, AjaxResult>` or an `AjaxResult[]` (depending on the `calls` format). The default is `false` - object containing the complete array of retrieved data. |

### Return Value

`Promise<Result>`{lang="ts-type"} — a promise that resolves to a [`Result`](/docs/core/result/) object. This object provides:

* `.getData()`{lang="ts-type"} — returns response data. The structure depends on the call parameters.
* `.isSuccess: boolean`{lang="ts-type"} — a flag indicating the successful completion of the request.
* `.getErrorMessages(): string[]`{lang="ts-type"} — an array of error messages.

## Key Concepts

### Batch Request Formats

1. **Object with named commands:**
   ```ts
   {
     deals: { method: 'crm.item.list', params: { entityTypeId: EnumCrmEntityTypeId.deal, select: ['id'] } },
     contacts: ['crm.item.list', { entityTypeId: EnumCrmEntityTypeId.contact, select: ['id'] }]
   }
   ```
   When `returnAjaxResult: true`, `Record<string, AjaxResult>`{lang="ts-type"} is returned.
2. **Array of arrays:**
   ```ts
   [
     ['crm.item.list', { entityTypeId: EnumCrmEntityTypeId.deal, select: ['id']'] }],
     ['crm.item.list', { entityTypeId: EnumCrmEntityTypeId.contact, select: ['id'] }]
   ]
   ```
   When `returnAjaxResult: true`, `AjaxResult[]`{lang="ts-type"} is returned.

3. **Array of objects:**
   ```ts
   [
     { method: 'crm.item.list', params: { entityTypeId: EnumCrmEntityTypeId.deal, select: ['id']'] } },
     { method: 'crm.item.list', params: { entityTypeId: EnumCrmEntityTypeId.contact, select: ['id']'] } }
   ]
   ```
   When `returnAjaxResult: true`, `AjaxResult[]`{lang="ts-type"} is returned.

### Links between teams

In batch queries, you can use the results of one command as parameters for another using a special syntax:

```ts
await $b24.callBatch({
  FirstDeal: {
    method: 'crm.item.list',
    params: { entityTypeId: EnumCrmEntityTypeId.deal, order: { id: 'desc' }, select: ['id'] }
  },
  DealTasks: {
    method: 'tasks.task.list',
    params: {
      filter: {
        UF_CRM_TASK: 'D_$result[FirstDeal][items][0][id]' // Link to the result of the first command
      }
    }
  }
})
```

### Important Limitations

- **Maximum 50 commands** in a single batch request.
- **Total execution time** must not exceed Bitrix24 limits (usually 30-60 seconds).
- **API Limits:** A batch request is counted as a single API request, but each command within it counts toward the overall operation limits.
- **Execution Order:** Commands in a batch are executed sequentially in the order they are specified.

### Error Handling

Always check the result using `isSuccess` and handle errors.

```ts
const response: Result<Record<string, AjaxResult>> = await $b24.callBatch({
  ServerTime: { method: 'server.time' }
}, true) // isHaltOnError = true

if (!response.isSuccess) {
  // Handling API error
  console.error(new Error(`API Error: ${response.getErrorMessages().join('; ')}`))
  return
}

// Working with a successful result
const data = response.getData()
```

## Examples

### Batch request in object format

::component-example
---
border: false
preview: false
collapse: false
name: 'hook-call-batch-example'
filename: 'BatchObject'
lang: 'ts'
---
::

### Using returnAjaxResult for fine-grained control

::component-example
---
border: false
preview: false
collapse: false
name: 'hook-call-batch-with-ajax-result-for-fine-grained-control-example'
filename: 'BatchWithAjaxResult'
lang: 'ts'
---
::

### Combined package with links between commands

::component-example
---
border: false
preview: false
collapse: false
name: 'hook-call-batch-combined-package-with-links-between-commands-example'
filename: 'BatchWithReferences'
lang: 'ts'
---
::

## Alternatives and Recommendations

- **To get the entire list in memory:** Use [`callFastListMethod`](/docs/hook/methods/call-fast-list-method/), which returns the entire array of data.
- **For step-by-step streaming processing of very large lists:** Use [`fetchListMethod`](/docs/hook/methods/fetch-list-method/). Returns an async generator that yields data page by page, allowing processing to start before the entire list is loaded and saving memory.
- **When you need the total item count:** Use the regular [`callMethod`](/docs/hook/methods/call-method/) with manual pagination, as `callFastListMethod` does not count the total.
- **To run more commands (more than 50):** Use [`callBatchByChunk`](/docs/hook/methods/call-batch-by-chunk/), which automatically splits commands into chunks of 50.
- **On the client (browser):** Use the built-in [`B24Frame`](/docs/frame/) object instead of `B24Hook`.

## References

* **[AjaxResult](/docs/core/ajax-result/)** — Documentation for the result object.
* **[Result](/docs/core/result/)** — Documentation for the result object.
* **[Official Bitrix24 REST API Documentation](https://apidocs.bitrix24.com/)** — Reference for all available methods.
* **[Working with Large Volumes of Data](https://apidocs.bitrix24.com/settings/performance/huge-data.html)** — Recommendations for optimizing code to retrieve large data.
