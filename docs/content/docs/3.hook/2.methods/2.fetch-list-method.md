---
title: B24Hook.fetchListMethod()
description: 'Use `B24Hook.fetchListMethod()` for step-by-step stream processing of very large data lists. It returns an asynchronous generator that fetches data page by page, allowing processing to begin before the entire list has finished loading and conserving memory. It doesn't count the total number of records. Works only in server environment.'
navigation:
  title: fetchListMethod
links:
  - label: B24Hook
    iconName: GitHubIcon
    to: https://github.com/bitrix24/b24jssdk/blob/main/packages/jssdk/src/hook/controller.ts
  - label: TypeB24
    iconName: GitHubIcon
    to: https://github.com/bitrix24/b24jssdk/blob/main/packages/jssdk/src/types/b24.ts
  - label: LoggerBrowser
    iconName: GitHubIcon
    to: https://github.com/bitrix24/b24jssdk/blob/main/packages/jssdk/src/logger/browser.ts
---

::caution{title="⚠️ CAUTION: SECURITY"}
The `B24Hook` object is intended **exclusively for use on the server**.

- A webhook contains a secret access key, which **MUST NOT** be used in client-side code (browser, mobile app).
- For the client side, use [`B24Frame`](/docs/frame/).
::

## Quick Overview

To save memory, use `fetchListMethod`{lang="ts-type"} — the method returns an asynchronous generator for iterating through large lists. It doesn't count the total number of records.

The method returns an `AsyncGenerator` with the response data.

```ts
// Basic usage
import { B24Hook } from '@bitrix24/b24jssdk'

const $b24 = B24Hook.fromWebhookUrl('https://ваш_домен.bitrix24.ru/rest/1/webhook_код/')

try {
  for await (const chunk of $b24.fetchListMethod('crm.item.list', {
    entityTypeId: 2, // Entity type ID (e.g., 2 for Company)
    select: ['id', 'title']
  }, 'id', 'items')) {
    $logger.info(`Items received [${chunk.length}]`, chunk)
  }
} catch (error) {
  $logger.error(error)
}
```

## Method Signature

```ts-type
fetchListMethod<T = unknown>(
  method: string,
  params: {
    order?: any
    filter?: any
    [key: string]: any
  },
  idKey?: string,
  customKeyForResult?: string | null
): AsyncGenerator<T[]>
```

### Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| **`method`** | `string`{lang="ts-type"} | Yes | The name of the REST API method to call (e.g., `crm.item.list`). |
| **`params`** | `object`{lang="ts-type"} | No | An object with parameters to pass to the API method. Can contain `order`, `filter`, and other valid parameters. **Important:** Do not pass the `start` parameter — the method manages it automatically. |
| **`idKey`** | `string`{lang="ts-type"} | No |  **ID field name.** Specifies the field used for filtering during optimized pagination. Default is `'ID'`. Use `'id'` (lowercase) if the API method returns IDs in that format. |
| **`customKeyForResult`** | `string`{lang="ts-type"} | No | **Custom key for data extraction.** If the API method returns the result not in the main `result` field but in a nested one (e.g., `result.tasks`), specify the key here (e.g., `'tasks'`). Default is `null` (data is taken from the root of `result`). |

### Return Value

`AsyncGenerator<T[]>`{lang="ts-type"} — возвращает данные ответа API.

## Key Concepts

Optimized pagination without counting

`fetchListMethod` uses a special optimization for quickly retrieving large data volumes:

1. **Disabling total count:** Uses the `start: -1` parameter, which disables the calculation of the total number of items, significantly speeding up request execution.
2. **Filtering by ID:** After receiving each page of data, the method updates the filter, adding a condition `'>ID': lastId` to get the next batch of data.
3. **Automatic completion:** The process continues until an empty response is received.

### Important Limitations

- **Mandatory sorting by ID:** The method requires that the sorting order by the ID field be specified in the parameters (e.g., `order: { id: 'asc' }`). This is necessary for the filtering to work correctly.

### Error Handling

In case of an error, the method throws an exception.

```ts
try {
  for await (const chunk of $b24.fetchListMethod('some.method', {}, 'id', 'items')) {
    $logger.info(`Items received [${chunk.length}]`, chunk)
  }
} catch (error) {
  $logger.error(error)
}
```

## Examples

### Getting all companies with filtering

::component-example
---
border: false
preview: false
collapse: false
name: 'hook-fetch-list-method-getting-all-crm-items-with-filtering-example'
filename: 'AllCrmItems'
lang: 'ts'
---
::

### Export all deals with the specific stage and the date of stage change.

::component-example
---
border: false
preview: false
collapse: false
name: 'hook-fetch-list-method-export-all-crm-deals-with-specific-stage-and-stage-change-date-example'
filename: 'ExportAllDealsByStage'
lang: 'ts'
---
::

### Task processing

::component-example
---
border: false
preview: false
collapse: false
name: 'hook-fetch-list-method-process-all-tasks-example'
name: 'hookFetchListMethodProcessAllTasksExample'
filename: 'ProcessAllTasks'
lang: 'ts'
---
::

## Alternatives and Recommendations

- **For batch operations:** Use [`callBatch`](/docs/hook/methods/call-batch/) to execute up to 50 commands in a single request.
- **When you need the total item count:** Use the regular [`callMethod`](/docs/hook/methods/call-method/) with manual pagination.
- **To get the entire list in memory:** Use [`callFastListMethod`](/docs/hook/methods/call-fast-list-method/), which returns the entire array of data.
- **On the client (browser):** Use the built-in [`B24Frame`](/docs/frame/) object instead of `B24Hook`.

## References

* **[Official Bitrix24 REST API Documentation](https://apidocs.bitrix24.com/)** — Reference for all available methods.
* **[Working with Large Volumes of Data](https://apidocs.bitrix24.com/settings/performance/huge-data.html)** — Recommendations for optimizing code to retrieve large data.
